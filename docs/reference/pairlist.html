<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Helpers for pairlist and language nodes — pairlist • rlang</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>

<!-- Bootstrap -->
<link href="../tidyverse.css" rel="stylesheet">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- tidyverse -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="../index.html">rlang</a>
        <small class="tidyverse">part of the <a href="http://tidyverse.org">tidyverse</a></small>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Helpers for pairlist and language nodes</h1>
    </div>

    
    <p>Like any <a href = 'https://en.wikipedia.org/wiki/Parse_tree'>parse tree</a>, R
expressions are structured as trees of nodes. Each node has two
components: the head and the tail (though technically there is
actually a third component for argument names, see details). Due to
R's <a href = 'https://en.wikipedia.org/wiki/CAR_and_CDR'>lisp roots</a>, the
head of a node (or cons cell) is called the CAR and the tail is
called the CDR (pronounced <em>car</em> and <em>cou-der</em>). While R's ordinary
subsetting operators have builtin support for indexing into these
trees and replacing elements, it is sometimes useful to manipulate
the nodes more directly. This is the purpose of functions like
<code>node_car()</code> and <code>mut_node_car()</code>. They are particularly useful to
prototype algorithms for your C-level functions.</p><ul>
<li><p><code>node_car()</code> and <code>mut_node_car()</code> access or change the head of a node.</p></li>
<li><p><code>node_cdr()</code> and <code>mut_node_cdr()</code> access or change the tail of a node.</p></li>
<li><p>Variants like <code>node_caar()</code> or <code>mut_node_cdar()</code> deal with the
CAR of the CAR of a node or the CDR of the CAR of a node
respectively. The letters in the middle indicate the type (CAR or
CDR) and order of access.</p></li>
<li><p><code>node_tag()</code> and <code>mut_node_tag()</code> access or change the tag of a
node. This is meant for argument names and should only contain
symbols (not strings).</p></li>
<li><p><code>node()</code> creates a new node from two components.</p></li>
</ul>
    

    <pre class="usage"><span class='fu'>node</span>(<span class='no'>newcar</span>, <span class='no'>newcdr</span>)

<span class='fu'>node_car</span>(<span class='no'>x</span>)

<span class='fu'>node_cdr</span>(<span class='no'>x</span>)

<span class='fu'>node_caar</span>(<span class='no'>x</span>)

<span class='fu'>node_cadr</span>(<span class='no'>x</span>)

<span class='fu'>node_cdar</span>(<span class='no'>x</span>)

<span class='fu'>node_cddr</span>(<span class='no'>x</span>)

<span class='fu'>mut_node_car</span>(<span class='no'>x</span>, <span class='no'>newcar</span>)

<span class='fu'>mut_node_cdr</span>(<span class='no'>x</span>, <span class='no'>newcdr</span>)

<span class='fu'>mut_node_caar</span>(<span class='no'>x</span>)

<span class='fu'>mut_node_cadr</span>(<span class='no'>x</span>, <span class='no'>newcar</span>)

<span class='fu'>mut_node_cdar</span>(<span class='no'>x</span>)

<span class='fu'>mut_node_cddr</span>(<span class='no'>x</span>, <span class='no'>newcdr</span>)

<span class='fu'>node_tag</span>(<span class='no'>x</span>)

<span class='fu'>mut_node_tag</span>(<span class='no'>x</span>, <span class='no'>newtag</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>newcar, newcdr</th>
      <td><p>The new CAR or CDR for the node. These can be
any R objects.</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>A language or pairlist node. Note that these functions are
barebones and do not perform any type checking.</p></td>
    </tr>
    <tr>
      <th>newtag</th>
      <td><p>The new tag for the node. This should be a symbol.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>R has two types of nodes to represent parse trees: language nodes,
which represent function calls, and pairlist nodes, which represent
arguments in a function call. These are the exact same data
structures with a different name. This distinction is helpful for
parsing the tree: the top-level node of a function call always has
<em>language</em> type while its arguments have <em>pairlist</em> type.</p>
<p>Note that it is risky to manipulate calls at the node level. First,
the calls are changed inplace. This is unlike base R operators
which create a new copy of the language tree for each modification.
To make sure modifying a language object does not produce
side-effects, rlang exports the <code>duplicate()</code> function to create
deep copy (or optionally a shallow copy, i.e. only the top-level
node is copied). The second danger is that R expects language trees
to be structured as a <code>NULL</code>-terminated list. The CAR of a node is
a data slot and can contain anything, including another node (which
is how you form trees, as opposed to mere linked lists). On the
other hand, the CDR has to be either another node, or <code>NULL</code>. If it
is terminated by anything other than the <code>NULL</code> object, many R
commands will crash, including functions like <code>str()</code>. It is up to
you to ensure that the language list you have modified is
<code>NULL</code>-terminated.</p>
<p>Finally, all nodes can contain metadata in the TAG slot. This is
meant for argument names and R expects tags to contain a symbol
(not a string).</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code><a href='duplicate.html'>duplicate()</a></code> for creating copy-safe objects,
<code><a href='lang_head.html'>lang_head()</a></code> and <code><a href='lang_head.html'>lang_tail()</a></code> as slightly higher level
alternatives that check their input, and <code><a href='http://www.rdocumentation.org/packages/base/topics/list'>base::pairlist()</a></code> for
an easier way of creating a linked list of nodes.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Changing a node component happens in place and can have side</span>
<span class='co'># effects. Let's create a language object and a copy of it:</span>
<span class='no'>lang</span> <span class='kw'>&lt;-</span> <span class='fu'>quote</span>(<span class='fu'>foo</span>(<span class='no'>bar</span>))
<span class='no'>copy</span> <span class='kw'>&lt;-</span> <span class='no'>lang</span>

<span class='co'># Using R's builtin operators to change the language tree does not</span>
<span class='co'># create side effects:</span>
<span class='no'>copy</span><span class='kw'>[[</span><span class='fl'>2</span>]] <span class='kw'>&lt;-</span> <span class='fu'>quote</span>(<span class='no'>baz</span>)
<span class='no'>copy</span></div><div class='output co'>#&gt; foo(baz)</div><div class='input'><span class='no'>lang</span></div><div class='output co'>#&gt; foo(bar)</div><div class='input'>
<span class='co'># On the other hand, the CAR and CDR operators operate in-place. Let's</span>
<span class='co'># create new objects since the previous examples triggered a copy:</span>
<span class='no'>lang</span> <span class='kw'>&lt;-</span> <span class='fu'>quote</span>(<span class='fu'>foo</span>(<span class='no'>bar</span>))
<span class='no'>copy</span> <span class='kw'>&lt;-</span> <span class='no'>lang</span>

<span class='co'># Now we change the argument pairlist of `copy`, making sure the new</span>
<span class='co'># arguments are NULL-terminated:</span>
<span class='fu'>mut_node_cdr</span>(<span class='no'>copy</span>, <span class='fu'>node</span>(<span class='fu'>quote</span>(<span class='no'>BAZ</span>), <span class='kw'>NULL</span>))</div><div class='output co'>#&gt; foo(BAZ)</div><div class='input'>
<span class='co'># Or equivalently:</span>
<span class='fu'>mut_node_cdr</span>(<span class='no'>copy</span>, <span class='fu'>pairlist</span>(<span class='fu'>quote</span>(<span class='no'>BAZ</span>)))</div><div class='output co'>#&gt; foo(BAZ)</div><div class='input'><span class='no'>copy</span></div><div class='output co'>#&gt; foo(BAZ)</div><div class='input'>
<span class='co'># The original object has been changed in place:</span>
<span class='no'>lang</span></div><div class='output co'>#&gt; foo(BAZ)</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="tidyverse">
  <p>rlang is a part of the <strong>tidyverse</strong>, an ecosystem of packages designed with common APIs and a shared philosophy. Learn more at <a href="http://tidyverse.org">tidyverse.org</a>.</p>
</div>

<div class="author">
  <p>Developed by <a href='http://hadley.nz'>Hadley Wickham</a>, Lionel Henry.</p>
  <p>Site built by <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-67989-18', 'auto');
  ga('send', 'pageview');
</script>
      </footer>
   </div>

  </body>
</html>

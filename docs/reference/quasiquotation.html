<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Quasiquotation of an expression — quasiquotation • rlang</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>

<!-- Bootstrap -->
<link href="../tidyverse.css" rel="stylesheet">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- tidyverse -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="../index.html">rlang</a>
        <small class="tidyverse">part of the <a href="http://tidyverse.org">tidyverse</a></small>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Quasiquotation of an expression</h1>
    </div>

    
    <p>Quasiquotation is the mechanism that makes it possible to program
flexibly with <a href='tidy-evaluation.html'>tidyeval</a> grammars like dplyr. It
is enabled in all tidyeval functions, the most fundamental of which
are <code><a href='quosure.html'>quo()</a></code> and <code><a href='expr.html'>expr()</a></code>.</p>
<p>Quasiquotation is the combination of quoting an expression while
allowing immediate evaluation (unquoting) of part of that
expression. We provide both syntactic operators and functional
forms for unquoting.</p><ul>
<li><p><code>UQ()</code> and the <code>!!</code> operator unquote their argument. It gets
evaluated immediately in the surrounding context.</p></li>
<li><p><code>UQE()</code> is like <code>UQ()</code> but retrieves the expression of
<a href='is_quosure.html'>quosureish</a> objects. It is a shortcut for <code>!! get_expr(x)</code>. Use this with care: it is potentially unsafe to
discard the environment of the quosure.</p></li>
<li><p><code>UQS()</code> and the <code>!!!</code> operators unquote and splice their
argument. The argument should evaluate to a vector or an
expression. Each component of the vector is embedded as its own
argument in the surrounding call. If the vector is named, the
names are used as argument names.</p></li>
</ul>
    

    <pre class="usage"><span class='fu'>UQ</span>(<span class='no'>x</span>)

<span class='fu'>UQE</span>(<span class='no'>x</span>)

<span class='st'>"!!"</span>(<span class='no'>x</span>)

<span class='fu'>UQS</span>(<span class='no'>x</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>An expression to unquote.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="theory"><a class="anchor" href="#theory"></a>Theory</h2>

    
    <p>Formally, <code>quo()</code> and <code>expr()</code> are quasiquote functions, <code>UQ()</code> is
the unquote operator, and <code>UQS()</code> is the unquote splice operator.
These terms have a rich history in Lisp languages, and live on in
modern languages like
<a href = 'http://docs.julialang.org/en/release-0.1/manual/metaprogramming/'>Julia</a>
and
<a href = 'https://docs.racket-lang.org/reference/quasiquote.html'>Racket</a>.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Quasiquotation functions act like base::quote()</span>
<span class='fu'>quote</span>(<span class='fu'>foo</span>(<span class='no'>bar</span>))</div><div class='output co'>#&gt; foo(bar)</div><div class='input'><span class='fu'><a href='expr.html'>expr</a></span>(<span class='fu'>foo</span>(<span class='no'>bar</span>))</div><div class='output co'>#&gt; foo(bar)</div><div class='input'><span class='fu'><a href='quosure.html'>quo</a></span>(<span class='fu'>foo</span>(<span class='no'>bar</span>))</div><div class='output co'>#&gt; &lt;quosure: local&gt;
#&gt; ~foo(bar)</div><div class='input'>
<span class='co'># In addition, they support unquoting:</span>
<span class='fu'><a href='expr.html'>expr</a></span>(<span class='fu'>foo</span>(<span class='fu'>UQ</span>(<span class='fl'>1</span> + <span class='fl'>2</span>)))</div><div class='output co'>#&gt; foo(3)</div><div class='input'><span class='fu'><a href='expr.html'>expr</a></span>(<span class='fu'>foo</span>(!! <span class='fl'>1</span> + <span class='fl'>2</span>))</div><div class='output co'>#&gt; foo(3)</div><div class='input'><span class='fu'><a href='quosure.html'>quo</a></span>(<span class='fu'>foo</span>(!! <span class='fl'>1</span> + <span class='fl'>2</span>))</div><div class='output co'>#&gt; &lt;quosure: local&gt;
#&gt; ~foo(3)</div><div class='input'>
<span class='co'># The !! operator is a handy syntactic shortcut for unquoting with</span>
<span class='co'># UQ().  However you need to be a bit careful with operator</span>
<span class='co'># precedence. All arithmetic and comparison operators bind more</span>
<span class='co'># tightly than `!`:</span>
<span class='fu'><a href='quosure.html'>quo</a></span>(<span class='fl'>1</span> +  !! (<span class='fl'>1</span> + <span class='fl'>2</span> + <span class='fl'>3</span>) + <span class='fl'>10</span>)</div><div class='output co'>#&gt; &lt;quosure: local&gt;
#&gt; ~1 + 16</div><div class='input'>
<span class='co'># For this reason you should always wrap the unquoted expression</span>
<span class='co'># with parentheses when operators are involved:</span>
<span class='fu'><a href='quosure.html'>quo</a></span>(<span class='fl'>1</span> + (!! <span class='fl'>1</span> + <span class='fl'>2</span> + <span class='fl'>3</span>) + <span class='fl'>10</span>)</div><div class='output co'>#&gt; &lt;quosure: local&gt;
#&gt; ~1 + (6) + 10</div><div class='input'>
<span class='co'># Or you can use the explicit unquote function:</span>
<span class='fu'><a href='quosure.html'>quo</a></span>(<span class='fl'>1</span> + <span class='fu'>UQ</span>(<span class='fl'>1</span> + <span class='fl'>2</span> + <span class='fl'>3</span>) + <span class='fl'>10</span>)</div><div class='output co'>#&gt; &lt;quosure: local&gt;
#&gt; ~1 + 6 + 10</div><div class='input'>

<span class='co'># Use !!! or UQS() if you want to add multiple arguments to a</span>
<span class='co'># function It must evaluate to a list</span>
<span class='no'>args</span> <span class='kw'>&lt;-</span> <span class='fu'>list</span>(<span class='fl'>1</span>:<span class='fl'>10</span>, <span class='kw'>na.rm</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='fu'><a href='quosure.html'>quo</a></span>(<span class='fu'>mean</span>( <span class='fu'>UQS</span>(<span class='no'>args</span>) ))</div><div class='output co'>#&gt; &lt;quosure: local&gt;
#&gt; ~mean(1:10, na.rm = TRUE)</div><div class='input'>
<span class='co'># You can combine the two</span>
<span class='no'>var</span> <span class='kw'>&lt;-</span> <span class='fu'>quote</span>(<span class='no'>xyz</span>)
<span class='no'>extra_args</span> <span class='kw'>&lt;-</span> <span class='fu'>list</span>(<span class='kw'>trim</span> <span class='kw'>=</span> <span class='fl'>0.9</span>, <span class='kw'>na.rm</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='fu'><a href='quosure.html'>quo</a></span>(<span class='fu'>mean</span>(<span class='fu'>UQ</span>(<span class='no'>var</span>) , <span class='fu'>UQS</span>(<span class='no'>extra_args</span>)))</div><div class='output co'>#&gt; &lt;quosure: local&gt;
#&gt; ~mean(xyz, trim = 0.9, na.rm = TRUE)</div><div class='input'>

<span class='co'># Unquoting is especially useful for transforming successively a</span>
<span class='co'># captured expression:</span>
<span class='no'>quo</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='quosure.html'>quo</a></span>(<span class='fu'>foo</span>(<span class='no'>bar</span>))
<span class='no'>quo</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='quosure.html'>quo</a></span>(<span class='fu'>inner</span>(!! <span class='no'>quo</span>, <span class='no'>arg1</span>))
<span class='no'>quo</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='quosure.html'>quo</a></span>(<span class='fu'>outer</span>(!! <span class='no'>quo</span>, !!! <span class='fu'><a href='sym.html'>syms</a></span>(<span class='no'>letters</span>[<span class='fl'>1</span>:<span class='fl'>3</span>])))
<span class='no'>quo</span></div><div class='output co'>#&gt; &lt;quosure: local&gt;
#&gt; ~outer(~inner(~foo(bar), arg1), a, b, c)</div><div class='input'>
<span class='co'># Since we are building the expression in the same environment, you</span>
<span class='co'># can also start with raw expressions and create a quosure in the</span>
<span class='co'># very last step to record the dynamic environment:</span>
<span class='no'>expr</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='expr.html'>expr</a></span>(<span class='fu'>foo</span>(<span class='no'>bar</span>))
<span class='no'>expr</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='expr.html'>expr</a></span>(<span class='fu'>inner</span>(!! <span class='no'>expr</span>, <span class='no'>arg1</span>))
<span class='no'>quo</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='quosure.html'>quo</a></span>(<span class='fu'>outer</span>(!! <span class='no'>expr</span>, !!! <span class='fu'><a href='sym.html'>syms</a></span>(<span class='no'>letters</span>[<span class='fl'>1</span>:<span class='fl'>3</span>])))
<span class='no'>quo</span></div><div class='output co'>#&gt; &lt;quosure: local&gt;
#&gt; ~outer(inner(foo(bar), arg1), a, b, c)</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#theory">Theory</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="tidyverse">
  <p>rlang is a part of the <strong>tidyverse</strong>, an ecosystem of packages designed with common APIs and a shared philosophy. Learn more at <a href="http://tidyverse.org">tidyverse.org</a>.</p>
</div>

<div class="author">
  <p>Developed by <a href='http://hadley.nz'>Hadley Wickham</a>, Lionel Henry.</p>
  <p>Site built by <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-67989-18', 'auto');
  ga('send', 'pageview');
</script>
      </footer>
   </div>

  </body>
</html>

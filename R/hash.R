#' Hash an object
#'
#' @description
#' `hash()` hashes an arbitrary R object.
#'
#' The generated hash is guaranteed to be reproducible across platforms that
#' have the same endianness and are using the same R version.
#'
#' @details
#' `hash()` uses the XXH128 hash algorithm of the xxHash library, which
#' generates a 128-bit hash. It is implemented as a streaming hash, which
#' generates the hash with minimal extra memory usage.
#'
#' Objects are converted to binary using R's native serialization tools.
#' On R >= 3.5.0, serialization version 3 is used, otherwise version 2 is used.
#' See [serialize()] for more information about the serialization version.
#'
#' @param x An object.
#'
#' @export
#' @examples
#' hash(c(1, 2, 3))
#' hash(mtcars)
hash <- function(x) {
  .Call(ffi_hash, x)
}

# Keep this alias for a while
# https://github.com/r-lib/rlang/issues/1177
on_load(
  rlang_hash <- ffi_hash
)

# ------------------------------------------------------------------------------

hash_file <- function(path) {
  path <- normalizePath(path, mustWork = TRUE)
  .Call(ffi_hash_file, path)
}
